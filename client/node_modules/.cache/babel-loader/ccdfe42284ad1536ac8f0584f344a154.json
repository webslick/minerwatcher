{"ast":null,"code":"import _regeneratorRuntime from\"/home/minerwatcher/minerwatcher/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/minerwatcher/minerwatcher/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/minerwatcher/minerwatcher/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/minerwatcher/minerwatcher/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/minerwatcher/minerwatcher/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/minerwatcher/minerwatcher/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/minerwatcher/minerwatcher/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";/* eslint-disable no-undef */ /* eslint-disable no-unused-vars */import'./App.css';import React from'react';import{connect}from'react-redux';import store from'./redux/store';import PopapLogin from'./components/PopapLogin/index';import HeaderMenu from'./components/HeaderMenu/index';import ItemCard from'./components/ItemCard/index';import TitleRig from'./components/TitleRig/index';import HeaderTable from'./components/HeaderTable/index';import{appGetUser,appPutUser,appGetRigs,appGetConfig,appPutRigs,copyDataRig,copyDataTemp,appPutRigsArr,appPutMail}from'./redux/actions/app';import{getWorkedRig,proccesingArrTimeToCards}from'./helpers';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var App=/*#__PURE__*/function(_React$Component){_inherits(App,_React$Component);var _super=_createSuper(App);function App(props){var _this;_classCallCheck(this,App);_this=_super.call(this,props);_this.intervalLoop=null;_this.updateDBApp=null;_this.updateWindowApp=null;_this.getActualDateBD=_this.getActualDateBD.bind(_assertThisInitialized(_this));return _this;}_createClass(App,[{key:\"componentDidMount\",value:function componentDidMount(){var _this$props=this.props,sinhronicDataTemp=_this$props.sinhronicDataTemp,sinhronicDataRig=_this$props.sinhronicDataRig,putTempArr=_this$props.putTempArr;this.updateDBApp=setInterval(this.getActualDateBD,60000*10);// Запрашиваем базу данных каждые 3 мин\nthis.processInterval=setInterval(function(){putTempArr(proccesingArrTimeToCards(store.getState().rigs.newData.cardsInfoArr,store.getState().config.newData));sinhronicDataTemp();sinhronicDataRig();},60010*10);// обробатываем инфу\nthis.getActualDateBD().then(function(){putTempArr(proccesingArrTimeToCards(store.getState().rigs.newData.cardsInfoArr,store.getState().config.newData));sinhronicDataTemp();sinhronicDataRig();});}},{key:\"getActualDateBD\",value:function(){var _getActualDateBD=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _this$props2,fetchGetUser,fetchGetRigs,fetchGetTempRigs;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:// DONE!\n_this$props2=this.props,fetchGetUser=_this$props2.fetchGetUser,fetchGetRigs=_this$props2.fetchGetRigs,fetchGetTempRigs=_this$props2.fetchGetTempRigs;_context.next=3;return fetchGetRigs(\"/api/getRigs?id=1\");case 3:_context.next=5;return fetchGetUser(\"/api/getAdmin?id=1\");case 5:_context.next=7;return fetchGetTempRigs(\"/api/getTempRigs?id=1\");case 7:case\"end\":return _context.stop();}}},_callee,this);}));function getActualDateBD(){return _getActualDateBD.apply(this,arguments);}return getActualDateBD;}()},{key:\"componentWillUnmount\",value:function componentWillUnmount(){clearInterval(this.updateWindowApp);clearInterval(this.updateDBApp);}},{key:\"render\",value:function render(){var _this2=this;var _this$props3=this.props,formPassword=_this$props3.formPassword,formLogin=_this$props3.formLogin,email=_this$props3.email,password=_this$props3.password,login=_this$props3.login,cardsInfoArr=_this$props3.cardsInfoArr,toogle_total_temp=_this$props3.toogle_total_temp,total_temp_max=_this$props3.total_temp_max,total_temp_min=_this$props3.total_temp_min,putUser=_this$props3.putUser,putMail=_this$props3.putMail;var work=getWorkedRig(cardsInfoArr);// if (true) {\nif(formLogin===login&&formPassword===password){return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsx(HeaderMenu,{userName:login,onClick:function onClick(event){putUser(event);}}),/*#__PURE__*/_jsx(TitleRig,{total:work[1],worked:work[0]}),/*#__PURE__*/_jsx(\"div\",{className:\"titleUpdateInfo\",children:\"Information updates every ten minutes\"}),/*#__PURE__*/_jsx(HeaderTable,{title:['Name','Status','Details']}),cardsInfoArr.map(function(obj,i,arr){return/*#__PURE__*/_jsx(ItemCard,{offtimer:_this2.props,login:email,tempConfig:{toogle_total_temp:toogle_total_temp,total_temp_max:total_temp_max,total_temp_min:total_temp_min},count:i+1,fill:arr[i],arr_temp:obj.temp_arr},i);})]});}else{return/*#__PURE__*/_jsx(\"div\",{className:\"App\",children:/*#__PURE__*/_jsx(PopapLogin,{onClick:function onClick(event){event.fogort?putMail(event):putUser(event);}})});}}}]);return App;}(React.Component);var mapStateToProps=function mapStateToProps(state){var _state$user=state.user,formLogin=_state$user.formLogin,formPassword=_state$user.formPassword,email=_state$user.email,password=_state$user.password,login=_state$user.login,config=state.config,_state$config$oldData=state.config.oldData,toogle_total_temp=_state$config$oldData.toogle_total_temp,total_temp_max=_state$config$oldData.total_temp_max,total_temp_min=_state$config$oldData.total_temp_min,rigs=state.rigs,cardsInfoArr=state.rigs.oldData.cardsInfoArr;return{rigs:rigs,config:config,formLogin:formLogin,formPassword:formPassword,email:email,password:password,login:login,toogle_total_temp:toogle_total_temp,total_temp_max:total_temp_max,total_temp_min:total_temp_min,cardsInfoArr:cardsInfoArr};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{fetchGetTempRigs:function(){var _fetchGetTempRigs=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(url){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:return _context2.abrupt(\"return\",Promise.resolve(dispatch(appGetConfig(url))));case 1:case\"end\":return _context2.stop();}}},_callee2);}));function fetchGetTempRigs(_x){return _fetchGetTempRigs.apply(this,arguments);}return fetchGetTempRigs;}(),fetchGetRigs:function(){var _fetchGetRigs=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(url){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:return _context3.abrupt(\"return\",Promise.resolve(dispatch(appGetRigs(url))));case 1:case\"end\":return _context3.stop();}}},_callee3);}));function fetchGetRigs(_x2){return _fetchGetRigs.apply(this,arguments);}return fetchGetRigs;}(),fetchPutRigs:function(){var _fetchPutRigs=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(arr){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:return _context4.abrupt(\"return\",Promise.resolve(dispatch(appPutRigs(arr))));case 1:case\"end\":return _context4.stop();}}},_callee4);}));function fetchPutRigs(_x3){return _fetchPutRigs.apply(this,arguments);}return fetchPutRigs;}(),fetchGetUser:function(){var _fetchGetUser=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(url){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:return _context5.abrupt(\"return\",Promise.resolve(dispatch(appGetUser(url))));case 1:case\"end\":return _context5.stop();}}},_callee5);}));function fetchGetUser(_x4){return _fetchGetUser.apply(this,arguments);}return fetchGetUser;}(),// fetchWriteDataTemp: async (url,data) => Promise.resolve(dispatch(writeDataTemp(url,data))),\nputUser:function(){var _putUser=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(data){return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:return _context6.abrupt(\"return\",Promise.resolve(dispatch(appPutUser(data))));case 1:case\"end\":return _context6.stop();}}},_callee6);}));function putUser(_x5){return _putUser.apply(this,arguments);}return putUser;}(),putMail:function(){var _putMail=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(data){return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:return _context7.abrupt(\"return\",Promise.resolve(dispatch(appPutMail(data))));case 1:case\"end\":return _context7.stop();}}},_callee7);}));function putMail(_x6){return _putMail.apply(this,arguments);}return putMail;}(),putTempArr:function(){var _putTempArr=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(data){return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:return _context8.abrupt(\"return\",Promise.resolve(dispatch(appPutRigsArr(data))));case 1:case\"end\":return _context8.stop();}}},_callee8);}));function putTempArr(_x7){return _putTempArr.apply(this,arguments);}return putTempArr;}(),sinhronicDataRig:function(){var _sinhronicDataRig=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(){return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:return _context9.abrupt(\"return\",Promise.resolve(dispatch(copyDataRig())));case 1:case\"end\":return _context9.stop();}}},_callee9);}));function sinhronicDataRig(){return _sinhronicDataRig.apply(this,arguments);}return sinhronicDataRig;}(),sinhronicDataTemp:function(){var _sinhronicDataTemp=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee10(){return _regeneratorRuntime.wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:return _context10.abrupt(\"return\",Promise.resolve(dispatch(copyDataTemp())));case 1:case\"end\":return _context10.stop();}}},_callee10);}));function sinhronicDataTemp(){return _sinhronicDataTemp.apply(this,arguments);}return sinhronicDataTemp;}()};};export default connect(mapStateToProps,mapDispatchToProps)(App);//zeppeling123","map":{"version":3,"sources":["/home/minerwatcher/minerwatcher/client/src/App.js"],"names":["React","connect","store","PopapLogin","HeaderMenu","ItemCard","TitleRig","HeaderTable","appGetUser","appPutUser","appGetRigs","appGetConfig","appPutRigs","copyDataRig","copyDataTemp","appPutRigsArr","appPutMail","getWorkedRig","proccesingArrTimeToCards","App","props","intervalLoop","updateDBApp","updateWindowApp","getActualDateBD","bind","sinhronicDataTemp","sinhronicDataRig","putTempArr","setInterval","processInterval","getState","rigs","newData","cardsInfoArr","config","then","fetchGetUser","fetchGetRigs","fetchGetTempRigs","clearInterval","formPassword","formLogin","email","password","login","toogle_total_temp","total_temp_max","total_temp_min","putUser","putMail","work","event","map","obj","i","arr","temp_arr","fogort","Component","mapStateToProps","state","user","oldData","mapDispatchToProps","dispatch","url","Promise","resolve","fetchPutRigs","data"],"mappings":"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","sourcesContent":["/* eslint-disable no-undef */\n/* eslint-disable no-unused-vars */\nimport './App.css'; \nimport React from 'react';\nimport { connect } from 'react-redux';\nimport store from './redux/store';\nimport PopapLogin from './components/PopapLogin/index';\nimport HeaderMenu from './components/HeaderMenu/index';\nimport ItemCard from './components/ItemCard/index';\nimport TitleRig from './components/TitleRig/index';\nimport HeaderTable from './components/HeaderTable/index';\nimport {\n  appGetUser,\n  appPutUser,\n  appGetRigs,\n  appGetConfig,\n  appPutRigs,\n  copyDataRig,\n  copyDataTemp,\n  appPutRigsArr,\n  appPutMail\n} from './redux/actions/app';\nimport { getWorkedRig,proccesingArrTimeToCards } from './helpers';\n\nclass App extends React.Component {\n  intervalLoop = null;\n  updateDBApp = null;\n  updateWindowApp = null;\n  \n  constructor( props ){\n    super( props );\n    this.getActualDateBD = this.getActualDateBD.bind(this);\n  }\n\n  componentDidMount() {\n    const {\n      // fetchWriteDataTemp,\n      sinhronicDataTemp,\n      sinhronicDataRig,\n      putTempArr,\n    } = this.props;\n    this.updateDBApp = setInterval(this.getActualDateBD,60000*10); // Запрашиваем базу данных каждые 3 мин\n    this.processInterval = setInterval(()=>{\n      putTempArr(\n        proccesingArrTimeToCards(store.getState().rigs.newData.cardsInfoArr,store.getState().config.newData)\n      );\n      sinhronicDataTemp();\n      sinhronicDataRig();\n    },60010*10); // обробатываем инфу\n    \n    this.getActualDateBD()\n    .then(() => {\n      putTempArr(\n        proccesingArrTimeToCards(store.getState().rigs.newData.cardsInfoArr,store.getState().config.newData)\n      );\n      sinhronicDataTemp();\n      sinhronicDataRig();\n    })\n  }\n\n  async getActualDateBD() { // DONE!\n    const { fetchGetUser,fetchGetRigs,fetchGetTempRigs } = this.props;\n    await fetchGetRigs(`/api/getRigs?id=1`);\n    await fetchGetUser(`/api/getAdmin?id=1`);\n    await fetchGetTempRigs(`/api/getTempRigs?id=1`);\n  }\n  componentWillUnmount() {\n    clearInterval(this.updateWindowApp);\n    clearInterval(this.updateDBApp);\n  }\n  \n  render() {\n    const {\n      formPassword,\n      formLogin,\n      email,\n      password,\n      login,\n      cardsInfoArr,\n      toogle_total_temp,\n      total_temp_max,\n      total_temp_min,\n      putUser,\n      putMail\n    } = this.props;\n    const work = getWorkedRig(cardsInfoArr);\n    // if (true) {\n    if (formLogin === login && formPassword === password) {\n      return (\n        <div className=\"App\">\n          <HeaderMenu userName={login} onClick={(event) => {\n             putUser(event);\n          }} />\n          <TitleRig total={work[1]} worked={work[0]}/>\n          <div className=\"titleUpdateInfo\">Information updates every ten minutes</div>\n          <HeaderTable title={['Name','Status','Details']} />\n          {\n            cardsInfoArr.map((obj,i,arr) => <ItemCard\n              offtimer={this.props} \n              login={email} \n              tempConfig={{\n                toogle_total_temp: toogle_total_temp,\n                total_temp_max: total_temp_max,\n                total_temp_min: total_temp_min\n              }} \n              count={i+1} \n              fill={arr[i]}\n              arr_temp={obj.temp_arr}\n              key={i} \n            />)\n           }\n        </div>\n      );\n    } else {\n      return (\n        <div className=\"App\">\n          <PopapLogin onClick={(event) => {\n            event.fogort ? putMail(event) : putUser(event);\n          }} />\n        </div>\n      );\n    }\n  }\n}\n\nconst mapStateToProps = state => {\n  const {\n    user:{\n      formLogin,\n      formPassword,\n      email,\n      password,\n      login\n    },\n    config,\n    config:{\n      oldData: {\n        toogle_total_temp,\n        total_temp_max,\n        total_temp_min\n      }\n    },\n    rigs,\n    rigs: {\n      oldData: {\n        cardsInfoArr\n      }\n    }\n  } = state;\n  return {\n    rigs,\n    config,\n    formLogin,\n    formPassword,\n    email,\n    password,\n    login,\n    toogle_total_temp,\n    total_temp_max,\n    total_temp_min,\n    cardsInfoArr \n  }\n}\nconst mapDispatchToProps = dispatch => {\n    return {\n      fetchGetTempRigs: async url => Promise.resolve(dispatch(appGetConfig(url))),\n      fetchGetRigs: async url => Promise.resolve(dispatch(appGetRigs(url))),\n      fetchPutRigs: async arr => Promise.resolve(dispatch(appPutRigs(arr))),\n      fetchGetUser: async url => Promise.resolve(dispatch(appGetUser(url))),\n      // fetchWriteDataTemp: async (url,data) => Promise.resolve(dispatch(writeDataTemp(url,data))),\n      putUser: async data => Promise.resolve(dispatch(appPutUser(data))),\n      putMail: async data => Promise.resolve(dispatch(appPutMail(data))),\n      putTempArr: async data => Promise.resolve(dispatch(appPutRigsArr(data))),\n      sinhronicDataRig: async () => Promise.resolve(dispatch(copyDataRig())),\n      sinhronicDataTemp: async () => Promise.resolve(dispatch(copyDataTemp())),\n    }\n}\n\nexport default connect(mapStateToProps,mapDispatchToProps)(App);\n//zeppeling123"]},"metadata":{},"sourceType":"module"}